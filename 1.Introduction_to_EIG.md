# Introduction to EIG

The Eigenstrat format is a text-based format used for storing genotype data in genetics. It consists of three files:

**1. .snp file**: containing the SNP positions. It consists of six columns: SNP-name, chromosome, genetic positions, physical position, reference allele, alternative allele.

**2. .ind file**: containing the names of the individuals. It consists of three columns: Individual Name, Sex (encoded as M(ale), F(emale), or U(nknown)), and population name.

**3. .geno file**: containing the genotype matrix, with individuals laid out from left to right, and SNP positions laid out from top to bottom.
-   0 means zero copies of reference allele.
-   1 means one copy of reference allele.
-   2 means two copies of reference allele.
-   9 means missing data.

MORE INFO: https://reich.hms.harvard.edu/software/InputFileFormats

## Merge datasets in EIGENSTRAT
You will need to install eigensoft as a conda environment:
```
conda activate
conda create -n eigensoft8 
conda install bioconda::eigensoft #v8 if you want to compute PCA with ellipses
```
Use the mergeit function:
```
conda activate eigensoft8

in1=$1
in2=$2
out=$3

mergeit -p <(echo "geno1: ${in1}.geno
snp1:  ${in1}.snp
ind1:  ${in1}.ind
geno2: ${in2}.geno
snp2:  ${in2}.snp
ind2:  ${in2}.ind
genooutfilename:   ${out}.geno
snpoutfilename:    ${out}.snp
indoutfilename:    ${out}.ind
outputformat:  EIGENSTRAT
docheck: YES
strandcheck:  YES
hashcheck: NO")
```
More info: https://github.com/argriffing/eigensoft/blob/master/CONVERTF/README

## Subset in EIGENSTRAT
Prepare a list of individuals/pop labels that you wan tto subset. The labels in that list have to match the labels of the third column in the .ind file.

Use the convertf function:
```
conda activate eigensoft

in1=$1 #geno and snp files prefix
in2=2 #ind file
out=$3 #output prefix
poplist=$4 #list of ind/pops to subset

convertf -p <(echo "genotypename:	${in1}.geno
snpname:	${in1}.snp
indivname:	${in2}
outputformat:	EIGENSTRAT 
genotypeoutname:	${out}.geno
snpoutname:	${out}.snp
indivoutname:	${out}.ind
poplistname:	${poplist}")
```
More info: https://github.com/argriffing/eigensoft/blob/master/CONVERTF/README

## Convert between PLINK and EIGENSTRAT
Use the convertf function.

- From EIG to PLINK:
```
in1=$1

convertf -p <(echo "genotypename:       ${in1}.geno
snpname:        ${in1}.snp
indivname:      ${in1}.ind
outputformat:   PACKEDPED
genotypeoutname:        ${in1}.bed
snpoutname:     ${in1}.bim
indivoutname:   ${in1}.fam")
```

- From PLINK to EIG:
```
in1=$1

convertf -p <(echo "genotypename:    <in>.bed
snpname:         <in>.bim
indivname:       <in>.fam
outputformat:    EIGENSTRAT
genotypeoutname: <out>.geno
snpoutname:      <out>.snp
indivoutname:    <out>.ind")
```
